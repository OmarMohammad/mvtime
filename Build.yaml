steps:
 - task: DotNetCoreCLI@1
   displayName: Restore NuGet Packages
   inputs:
     command: restore
     projects: '$(Parameters.RestoreBuildProjects)'

 - task: DotNetCoreCLI@1
   displayName: Restore NuGet Packages
   inputs:
      projects: '$(Parameters.RestoreBuildProjects)'
      arguments: '--configuration $(BuildConfiguration)'

  - task: DotNetCoreCLI@1
    displayName: Test
    inputs:
      command: test
      projects: '$(Parameters.TestProjects)'
      arguments: '--configuration $(BuildConfiguration)'

  - task: DotNetCoreCLI@1
    displayName: Prepare Publish Files
    inputs:
      command: publish
      publishWebProjects: True
      arguments: '--configuration $(BuildConfiguration) --output $(build.artifactstagingdirectory)'
      zipAfterPublish: True

  - task: PublishBuildArtifacts@1
    displayName: Publish Artifacts
    inputs:
      PathtoPublish: '$(build.artifactstagingdirectory)'
      ArtifactName: drop
      ArtifactType: Container
